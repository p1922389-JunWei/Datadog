{"title":"GenAI Security & Operations","description":"[[suggested_dashboards]]","widgets":[{"id":1000000000000001,"definition":{"type":"note","content":"# Application Overview","background_color":"blue","font_size":"14","text_align":"center","show_tick":false,"tick_pos":"50%","tick_edge":"bottom"},"layout":{"x":0,"y":0,"width":12,"height":1}},{"id":1644853264097670,"definition":{"title":"Average Latency","title_size":"16","title_align":"left","show_legend":false,"legend_layout":"auto","legend_columns":["avg","min","max","value","sum"],"time":{"type":"live","unit":"week","value":1},"type":"timeseries","requests":[{"formulas":[{"alias":"avg","formula":"query1"},{"alias":"p90","formula":"query2"},{"alias":"p95","formula":"query3"}],"queries":[{"data_source":"metrics","name":"query1","query":"avg:trace.fastapi.request{service:gemini-challenge-app,resource_name:post_/chat}"},{"data_source":"metrics","name":"query2","query":"p90:trace.fastapi.request{service:gemini-challenge-app,resource_name:post_/chat}"},{"data_source":"metrics","name":"query3","query":"p95:trace.fastapi.request{service:gemini-challenge-app,resource_name:post_/chat}"}],"response_format":"timeseries","style":{"palette":"green","line_type":"solid","line_width":"normal"},"display_type":"line"}]},"layout":{"x":0,"y":1,"width":4,"height":3}},{"id":5323406288462783,"definition":{"title":"Requests","title_size":"16","title_align":"left","show_legend":false,"legend_layout":"auto","legend_columns":["avg","min","max","value","sum"],"type":"timeseries","requests":[{"formulas":[{"alias":"Requests","formula":"query1"}],"queries":[{"data_source":"metrics","name":"query1","query":"sum:trace.fastapi.request.hits{*}.as_count()"}],"response_format":"timeseries","style":{"palette":"semantic","line_type":"solid","line_width":"normal"},"display_type":"bars"}]},"layout":{"x":4,"y":1,"width":4,"height":3}},{"id":1000000000000015,"definition":{"title":"Most Active Users","title_size":"16","title_align":"left","type":"toplist","requests":[{"queries":[{"name":"query1","data_source":"spans","search":{"query":""},"indexes":["*"],"group_by":[{"facet":"@user.id","limit":10,"sort":{"aggregation":"count","order":"desc","metric":"count"},"should_exclude_missing":true}],"compute":{"aggregation":"count"},"storage":"hot"}],"response_format":"scalar","formulas":[{"formula":"query1"}],"sort":{"count":500,"order_by":[{"type":"formula","index":0,"order":"desc"}]}}],"style":{"display":{"type":"stacked","legend":"automatic"},"palette":"datadog16"}},"layout":{"x":8,"y":1,"width":4,"height":3}},{"id":662031186214279,"definition":{"title":"Total Requests Hits","title_size":"16","title_align":"center","type":"query_value","requests":[{"response_format":"scalar","queries":[{"data_source":"metrics","name":"query1","query":"sum:trace.fastapi.request.hits{*}.as_count()","aggregator":"sum"}],"formulas":[{"formula":"query1"}],"conditional_formats":[{"comparator":"<","value":100,"palette":"white_on_yellow"},{"comparator":">=","value":100,"palette":"white_on_green"}]}],"autoscale":true,"precision":0},"layout":{"x":0,"y":4,"width":2,"height":2}},{"id":2194557324903125,"definition":{"title":"Avg Tokens Per Request","title_size":"16","title_align":"left","type":"query_value","requests":[{"queries":[{"name":"tokens","data_source":"spans","search":{"query":"@llm.tokens.total:*"},"indexes":["*"],"group_by":[],"compute":{"aggregation":"sum","metric":"@llm.tokens.total"},"storage":"hot"},{"name":"requests","data_source":"spans","search":{"query":"@llm.tokens.total:*"},"indexes":["*"],"group_by":[],"compute":{"aggregation":"count"},"storage":"hot"}],"formulas":[{"formula":"tokens / requests"}],"response_format":"scalar"}],"precision":0},"layout":{"x":2,"y":4,"width":3,"height":2}},{"id":1000000000000007,"definition":{"title":"API Health","title_size":"16","title_align":"left","show_legend":true,"legend_layout":"auto","legend_columns":["avg","min","max","value","sum"],"type":"timeseries","requests":[{"response_format":"timeseries","queries":[{"name":"query1","data_source":"spans","search":{"query":""},"indexes":["*"],"group_by":[{"facet":"@http.status_code","limit":10,"sort":{"aggregation":"count","order":"desc","metric":"count"},"should_exclude_missing":true}],"compute":{"aggregation":"count"},"storage":"hot"}],"formulas":[{"formula":"query1"}],"style":{"palette":"semantic","line_type":"solid","line_width":"normal"},"display_type":"line"}]},"layout":{"x":5,"y":4,"width":7,"height":4}},{"id":7315868074676545,"definition":{"title":"Total Tokens Used","title_size":"16","title_align":"left","type":"query_value","requests":[{"queries":[{"name":"query1","data_source":"spans","search":{"query":"@llm.tokens.total:*"},"indexes":["*"],"group_by":[],"compute":{"aggregation":"sum","metric":"@llm.tokens.total"},"storage":"hot"}],"formulas":[{"formula":"query1"}],"response_format":"scalar"}],"precision":0},"layout":{"x":0,"y":6,"width":2,"height":2}},{"id":1000000000000004,"definition":{"title":"API Success Rate","title_size":"16","title_align":"center","type":"query_value","requests":[{"conditional_formats":[{"comparator":">=","value":99,"palette":"white_on_green"},{"comparator":"<=","value":99.5,"palette":"white_on_yellow"},{"comparator":"<","value":99,"palette":"white_on_red"}],"response_format":"scalar","queries":[{"data_source":"metrics","name":"query2","query":"sum:trace.fastapi.request.hits{service:gemini-challenge-app}.as_count()","aggregator":"sum"},{"data_source":"metrics","name":"query1","query":"sum:trace.fastapi.request.errors{service:gemini-challenge-app}.as_count()","aggregator":"sum"}],"formulas":[{"number_format":{"unit":{"label":"%","type":"custom_unit_label"}},"formula":"(query2 - query1) / query2 * 100"}]}],"precision":2},"layout":{"x":2,"y":6,"width":3,"height":2}},{"id":1000000000000005,"definition":{"title":"Gemini API Rate Limit Exceeded","title_size":"16","title_align":"center","show_legend":true,"legend_layout":"auto","legend_columns":["avg","min","max","value","sum"],"type":"timeseries","requests":[{"formulas":[{"formula":"query1"}],"queries":[{"data_source":"metrics","name":"query1","query":"sum:gemini_chat_api.errors.rate_limit{*} by {service}.as_count()"}],"response_format":"timeseries","style":{"palette":"red","order_by":"values","line_type":"solid","line_width":"thick"},"display_type":"bars"}]},"layout":{"x":0,"y":8,"width":7,"height":3}},{"id":821396824896872,"definition":{"title":"Token Usage Over Time","title_size":"16","title_align":"left","show_legend":false,"legend_layout":"auto","legend_columns":["avg","min","max","value","sum"],"time":{"type":"live","unit":"week","value":1},"type":"timeseries","requests":[{"queries":[{"name":"input","data_source":"spans","search":{"query":"service:gemini-chat-api @llm.tokens.input:*"},"indexes":["*"],"group_by":[],"compute":{"aggregation":"sum","metric":"@llm.tokens.input"},"storage":"hot"},{"name":"output","data_source":"spans","search":{"query":"service:gemini-chat-api @llm.tokens.output:*"},"indexes":["*"],"group_by":[],"compute":{"aggregation":"sum","metric":"@llm.tokens.output"},"storage":"hot"}],"formulas":[{"alias":"Input Tokens","formula":"input"},{"alias":"Output Tokens","formula":"output"}],"response_format":"timeseries","style":{"palette":"dog_classic","line_type":"solid","line_width":"normal"},"display_type":"line"}]},"layout":{"x":7,"y":8,"width":5,"height":3}},{"id":1000000000000006,"definition":{"title":"Number of Jailbreaks","title_size":"16","title_align":"center","type":"query_value","requests":[{"formulas":[{"formula":"jailbreaks"}],"queries":[{"name":"jailbreaks","data_source":"spans","search":{"query":"@security.jailbreak_attempt:true"},"indexes":["*"],"group_by":[],"compute":{"aggregation":"count"},"storage":"hot"}],"response_format":"scalar","conditional_formats":[{"comparator":">=","value":1,"palette":"white_on_red"}]}],"autoscale":true,"precision":2,"timeseries_background":{"type":"area","yaxis":{"include_zero":true}}},"layout":{"x":0,"y":11,"width":3,"height":3}},{"id":1000000000000014,"definition":{"title":"Jailbreak Keyword Detection Events","title_size":"16","title_align":"left","show_legend":true,"legend_layout":"horizontal","legend_columns":["avg","min","max","value","sum"],"time":{"type":"live","unit":"week","value":1},"type":"timeseries","requests":[{"response_format":"timeseries","queries":[{"name":"query1","data_source":"spans","search":{"query":"@error.message:\"Jailbreak keyword detected\""},"indexes":["*"],"group_by":[],"compute":{"aggregation":"count"},"storage":"hot"}],"formulas":[{"formula":"query1"}],"style":{"palette":"red","line_type":"solid","line_width":"normal"},"display_type":"line"}]},"layout":{"x":3,"y":11,"width":9,"height":3}},{"id":1000000000000099,"definition":{"type":"note","content":"## Redis & Cache Performance","background_color":"gray","font_size":"14","text_align":"center","show_tick":false},"layout":{"x":0,"y":14,"width":12,"height":1}},{"id":1000000000000012,"definition":{"title":"Redis Memory Usage","title_size":"16","title_align":"left","show_legend":false,"legend_layout":"auto","legend_columns":["avg","min","max","value","sum"],"type":"timeseries","requests":[{"formulas":[{"alias":"usage","formula":"(query1 / query2) * 100"}],"queries":[{"data_source":"metrics","name":"query1","query":"avg:redis.mem.used{*}"},{"data_source":"metrics","name":"query2","query":"avg:redis.mem.maxmemory{*}"}],"response_format":"timeseries","style":{"palette":"purple","line_type":"solid","line_width":"normal"},"display_type":"line"}],"yaxis":{"label":"Usage %","scale":"linear","min":"0","max":"5"},"markers":[{"value":"y = 4","display_type":"error solid"},{"value":"y = 3","display_type":"warning dashed"}]},"layout":{"x":0,"y":15,"width":3,"height":3}},{"id":1000000000000009,"definition":{"title":"Cache Hit Rate Over Time","title_size":"16","title_align":"left","show_legend":true,"legend_layout":"auto","legend_columns":["avg","min","max","value","sum"],"time":{"type":"live","unit":"day","value":2},"type":"timeseries","requests":[{"formulas":[{"formula":"query1"}],"queries":[{"name":"query1","data_source":"spans","search":{"query":"service:gemini-chat-api @cache.hit:true"},"indexes":["*"],"compute":{"aggregation":"count"},"storage":"hot"}],"response_format":"timeseries","style":{"palette":"dog_classic","order_by":"values","order_reverse":false,"line_type":"solid","line_width":"normal"},"display_type":"bars"}]},"layout":{"x":3,"y":15,"width":4,"height":3}},{"id":1000000000000008,"definition":{"title":"Cache Hit vs API Call Latency","title_size":"16","title_align":"left","show_legend":true,"legend_layout":"auto","legend_columns":["avg","min","max","value"],"time":{"type":"live","unit":"day","value":2},"type":"timeseries","requests":[{"response_format":"timeseries","queries":[{"data_source":"spans","name":"query1","search":{"query":"service:gemini-chat-api @cache.hit:true"},"indexes":["*"],"group_by":[],"compute":{"aggregation":"avg","metric":"@duration"},"storage":"hot"}],"formulas":[{"alias":"Cache Hit","formula":"query1"}],"style":{"palette":"cool","line_type":"solid","line_width":"normal"},"display_type":"line"},{"response_format":"timeseries","queries":[{"data_source":"spans","name":"query1","search":{"query":"service:gemini-chat-api @cache.hit:false"},"indexes":["*"],"group_by":[],"compute":{"aggregation":"avg","metric":"@duration"},"storage":"hot"}],"formulas":[{"alias":"API Call","formula":"query1"}],"style":{"palette":"warm","line_type":"solid","line_width":"normal"},"display_type":"line"}],"yaxis":{"label":"Latency (ms)","scale":"log","min":"1","max":"auto"},"markers":[{"value":"y = 2000","display_type":"error dashed"},{"value":"y = 1000","display_type":"warning dashed"}]},"layout":{"x":7,"y":15,"width":5,"height":3}},{"id":1000000000000011,"definition":{"title":"Total Cache Hits","title_size":"16","title_align":"center","time":{"type":"live","unit":"month","value":1},"type":"query_value","requests":[{"response_format":"scalar","queries":[{"data_source":"spans","name":"query1","search":{"query":"service:gemini-chat-api @cache.hit:true"},"indexes":["*"],"compute":{"aggregation":"count"},"storage":"hot"}],"formulas":[{"formula":"query1"}]}],"precision":0},"layout":{"x":0,"y":18,"width":4,"height":4}},{"id":1000000000000010,"definition":{"title":"Cache Hits vs Misses","title_size":"16","title_align":"left","show_legend":true,"legend_layout":"auto","legend_columns":["avg","min","max","value","sum"],"time":{"type":"live","unit":"day","value":2},"type":"timeseries","requests":[{"response_format":"timeseries","queries":[{"data_source":"spans","name":"hits","search":{"query":"service:gemini-chat-api @cache.hit:true"},"indexes":["*"],"compute":{"aggregation":"count"},"storage":"hot"}],"formulas":[{"formula":"hits","alias":"Cache Hits"}],"style":{"palette":"green","line_type":"solid","line_width":"normal"},"display_type":"line"},{"response_format":"timeseries","queries":[{"data_source":"spans","name":"misses","search":{"query":"service:gemini-chat-api @cache.hit:false"},"indexes":["*"],"compute":{"aggregation":"count"},"storage":"hot"}],"formulas":[{"formula":"misses","alias":"Cache Misses"}],"style":{"palette":"red","line_type":"solid","line_width":"normal"},"display_type":"line"}]},"layout":{"x":4,"y":18,"width":8,"height":4}},{"id":1000000000000016,"definition":{"title":"Hosts Overview","background_color":"pink","show_title":true,"type":"group","layout_type":"ordered","widgets":[{"id":1000000000000017,"definition":{"title":"System uptime","type":"query_value","requests":[{"response_format":"scalar","queries":[{"data_source":"metrics","name":"query1","query":"avg:system.uptime{host:docker-desktop}","aggregator":"last"}]}],"autoscale":true,"precision":1},"layout":{"x":0,"y":0,"width":2,"height":4}},{"id":1000000000000018,"definition":{"title":"Amount of free and used disk space per device","type":"query_table","requests":[{"response_format":"scalar","queries":[{"data_source":"metrics","name":"query1","query":"avg:system.disk.free{host:docker-desktop} by {device}","aggregator":"last"},{"data_source":"metrics","name":"query2","query":"avg:system.disk.used{host:docker-desktop} by {device}","aggregator":"last"}],"sort":{"count":50,"order_by":[{"type":"formula","index":0,"order":"desc"}]},"formulas":[{"formula":"query1","alias":"Free disk space"},{"formula":"query2","alias":"Used disk space"}]}]},"layout":{"x":2,"y":0,"width":4,"height":4}},{"id":1000000000000019,"definition":{"title":"CPU usage breakdown (%)","show_legend":false,"legend_layout":"auto","legend_columns":["avg","min","max","value","sum"],"type":"timeseries","requests":[{"formulas":[{"alias":"Idle","formula":"query1"},{"alias":"System","formula":"query2"},{"alias":"IO Wait","formula":"query3"},{"alias":"User","formula":"query4"}],"response_format":"timeseries","queries":[{"query":"avg:system.cpu.idle{host:docker-desktop}","data_source":"metrics","name":"query1"},{"query":"avg:system.cpu.system{host:docker-desktop}","data_source":"metrics","name":"query2"},{"query":"avg:system.cpu.iowait{host:docker-desktop}","data_source":"metrics","name":"query3"},{"query":"avg:system.cpu.user{host:docker-desktop}","data_source":"metrics","name":"query4"}],"style":{"palette":"cool","line_type":"solid","line_width":"normal"},"display_type":"area"}],"yaxis":{"include_zero":true,"scale":"linear","label":"","min":"auto","max":"auto"}},"layout":{"x":6,"y":0,"width":6,"height":2}},{"id":1000000000000020,"definition":{"title":"RAM breakdown","show_legend":false,"legend_layout":"auto","legend_columns":["avg","min","max","value","sum"],"type":"timeseries","requests":[{"formulas":[{"formula":"query2","alias":"Total"}],"response_format":"timeseries","on_right_yaxis":false,"queries":[{"query":"sum:system.mem.total{host:docker-desktop}","data_source":"metrics","name":"query2"}],"style":{"palette":"cool","line_type":"solid","line_width":"normal"},"display_type":"area"},{"formulas":[{"formula":"query0","alias":"Used"}],"response_format":"timeseries","on_right_yaxis":false,"queries":[{"query":"sum:system.mem.used{*}","data_source":"metrics","name":"query0"}],"style":{"palette":"purple","line_type":"solid","line_width":"normal"},"display_type":"area"}],"yaxis":{"include_zero":true,"scale":"linear","label":"","min":"auto","max":"auto"},"markers":[]},"layout":{"x":6,"y":2,"width":6,"height":2}},{"id":1000000000000021,"definition":{"title":"Network traffic (bytes per sec)","show_legend":false,"legend_layout":"auto","legend_columns":["avg","min","max","value","sum"],"type":"timeseries","requests":[{"formulas":[{"alias":"Received","formula":"query1"}],"response_format":"timeseries","queries":[{"query":"sum:system.net.bytes_rcvd{host:docker-desktop}","data_source":"metrics","name":"query1"}],"style":{"palette":"dog_classic","line_type":"solid","line_width":"normal"},"display_type":"bars"},{"formulas":[{"alias":"Sent","formula":"0 - query1"}],"response_format":"timeseries","queries":[{"query":"sum:system.net.bytes_sent{host:docker-desktop}","data_source":"metrics","name":"query1"}],"style":{"palette":"warm","line_type":"solid","line_width":"normal"},"display_type":"bars"}],"yaxis":{"include_zero":true,"scale":"linear","label":"","min":"auto","max":"auto"}},"layout":{"x":0,"y":4,"width":4,"height":2}},{"id":1000000000000022,"definition":{"title":"Available Swap","show_legend":false,"legend_layout":"auto","legend_columns":["avg","min","max","value","sum"],"type":"timeseries","requests":[{"formulas":[{"alias":"Free","formula":"query1 * 100"}],"response_format":"timeseries","queries":[{"query":"avg:system.swap.pct_free{host:docker-desktop}","data_source":"metrics","name":"query1"}],"style":{"palette":"grey","line_type":"solid","line_width":"normal"},"display_type":"area"}],"yaxis":{"include_zero":true,"scale":"linear","label":"","min":"auto","max":"auto"}},"layout":{"x":4,"y":4,"width":4,"height":2}},{"id":6562698781294338,"definition":{"title":"","title_size":"16","title_align":"left","type":"query_value","requests":[{"response_format":"scalar","queries":[{"data_source":"spans","name":"query1","search":{"query":""},"indexes":[],"compute":{"aggregation":"count"},"group_by":[]}]}],"autoscale":true,"precision":2,"timeseries_background":{"type":"area"}},"layout":{"x":8,"y":4,"width":4,"height":2}}]},"layout":{"x":0,"y":0,"width":12,"height":7,"is_column_break":true}}],"template_variables":[],"layout_type":"ordered","notify_list":[],"reflow_type":"fixed","pause_auto_refresh":false}